{"ast":null,"code":"var _jsxFileName = \"/Users/maricrisbonzo/Desktop/magic-apps/membership-site/client/src/components/signup.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { magic } from \"../lib/magic\";\nimport { UserContext } from \"../lib/UserContext\";\nimport SignUpForm from \"./signup-form\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SignUp = () => {\n  _s();\n\n  const history = useHistory();\n  const [disabled, setDisabled] = useState(false);\n  const [, setUser] = useContext(UserContext);\n\n  async function handleSignUpWithEmail(email) {\n    try {\n      setDisabled(true); // Disable sign up button to prevent multiple emails from being triggered\n      // Trigger Magic link to be sent to user\n\n      let didToken = await magic.auth.loginWithMagicLink({\n        email\n      }); // Validate didToken with server\n\n      const res = await fetch(`${process.env.REACT_APP_SERVER_URL}/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + didToken\n        }\n      });\n\n      if (res.status === 200) {\n        // Set the UserContext to the now signed up user\n        let userMetadata = await magic.user.getMetadata();\n        await setUser(userMetadata);\n        history.push(\"/payment\");\n      }\n    } catch (error) {\n      setDisabled(false); // Re-enable sign up button - user may have requested to edit their email\n\n      console.log(error);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"h3-header\",\n      children: \"Sign Up for Lifetime Access Pass \\uD83D\\uDC69\\uD83C\\uDFFB\\u200D\\uD83D\\uDCBB\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"YAY! We're excited for you to sign up for a Lifetime Access Pass to awesomeness. First, please sign in below to register your new account:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"signup\",\n      children: /*#__PURE__*/_jsxDEV(SignUpForm, {\n        disabled: disabled,\n        onEmailSubmit: handleSignUpWithEmail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .h3-header {\n          font-size: 22px;\n          margin: 25px 0;\n        }\n        .signup {\n          max-width: 20rem;\n          margin: 40px auto 0;\n          padding: 1rem;\n          border: 1px solid #dfe1e5;\n          border-radius: 4px;\n          text-align: center;\n          box-shadow: 0px 0px 6px 6px #f7f7f7;\n          box-sizing: border-box;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(SignUp, \"DI6/Ii4AiOZvu+gGT36jBI92HYk=\", false, function () {\n  return [useHistory];\n});\n\n_c = SignUp;\nexport default SignUp;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignUp\");","map":{"version":3,"sources":["/Users/maricrisbonzo/Desktop/magic-apps/membership-site/client/src/components/signup.js"],"names":["useState","useEffect","useContext","useHistory","magic","UserContext","SignUpForm","SignUp","history","disabled","setDisabled","setUser","handleSignUpWithEmail","email","didToken","auth","loginWithMagicLink","res","fetch","process","env","REACT_APP_SERVER_URL","method","headers","Authorization","status","userMetadata","user","getMetadata","push","error","console","log"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,KAAT,QAAsB,cAAtB;AACA,SAASC,WAAT,QAA4B,oBAA5B;AACA,OAAOC,UAAP,MAAuB,eAAvB;;;;AAEA,MAAMC,MAAM,GAAG,MAAM;AAAA;;AACnB,QAAMC,OAAO,GAAGL,UAAU,EAA1B;AACA,QAAM,CAACM,QAAD,EAAWC,WAAX,IAA0BV,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,GAAGW,OAAH,IAAcT,UAAU,CAACG,WAAD,CAA9B;;AAEA,iBAAeO,qBAAf,CAAqCC,KAArC,EAA4C;AAC1C,QAAI;AACFH,MAAAA,WAAW,CAAC,IAAD,CAAX,CADE,CACiB;AAEnB;;AACA,UAAII,QAAQ,GAAG,MAAMV,KAAK,CAACW,IAAN,CAAWC,kBAAX,CAA8B;AACjDH,QAAAA;AADiD,OAA9B,CAArB,CAJE,CAQF;;AACA,YAAMI,GAAG,GAAG,MAAMC,KAAK,CAAE,GAAEC,OAAO,CAACC,GAAR,CAAYC,oBAAqB,QAArC,EAA8C;AACnEC,QAAAA,MAAM,EAAE,MAD2D;AAEnEC,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEPC,UAAAA,aAAa,EAAE,YAAYV;AAFpB;AAF0D,OAA9C,CAAvB;;AAQA,UAAIG,GAAG,CAACQ,MAAJ,KAAe,GAAnB,EAAwB;AACtB;AACA,YAAIC,YAAY,GAAG,MAAMtB,KAAK,CAACuB,IAAN,CAAWC,WAAX,EAAzB;AACA,cAAMjB,OAAO,CAACe,YAAD,CAAb;AACAlB,QAAAA,OAAO,CAACqB,IAAR,CAAa,UAAb;AACD;AACF,KAvBD,CAuBE,OAAOC,KAAP,EAAc;AACdpB,MAAAA,WAAW,CAAC,KAAD,CAAX,CADc,CACM;;AACpBqB,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD;AACF;;AAED,sBACE;AAAA,4BACE;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAME;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA,6BACE,QAAC,UAAD;AAAY,QAAA,QAAQ,EAAErB,QAAtB;AAAgC,QAAA,aAAa,EAAEG;AAA/C;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YANF,eASE;AAAA,gBAAS;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfM;AAAA;AAAA;AAAA;AAAA,YATF;AAAA,kBADF;AA4BD,CA/DD;;GAAML,M;UACYJ,U;;;KADZI,M;AAiEN,eAAeA,MAAf","sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { magic } from \"../lib/magic\";\nimport { UserContext } from \"../lib/UserContext\";\nimport SignUpForm from \"./signup-form\";\n\nconst SignUp = () => {\n  const history = useHistory();\n  const [disabled, setDisabled] = useState(false);\n  const [, setUser] = useContext(UserContext);\n\n  async function handleSignUpWithEmail(email) {\n    try {\n      setDisabled(true); // Disable sign up button to prevent multiple emails from being triggered\n\n      // Trigger Magic link to be sent to user\n      let didToken = await magic.auth.loginWithMagicLink({\n        email,\n      });\n\n      // Validate didToken with server\n      const res = await fetch(`${process.env.REACT_APP_SERVER_URL}/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + didToken,\n        },\n      });\n\n      if (res.status === 200) {\n        // Set the UserContext to the now signed up user\n        let userMetadata = await magic.user.getMetadata();\n        await setUser(userMetadata);\n        history.push(\"/payment\");\n      }\n    } catch (error) {\n      setDisabled(false); // Re-enable sign up button - user may have requested to edit their email\n      console.log(error);\n    }\n  }\n\n  return (\n    <>\n      <h3 className=\"h3-header\">Sign Up for Lifetime Access Pass üë©üèª‚Äçüíª</h3>\n      <p>\n        YAY! We're excited for you to sign up for a Lifetime Access Pass to\n        awesomeness. First, please sign in below to register your new account:\n      </p>\n      <div className=\"signup\">\n        <SignUpForm disabled={disabled} onEmailSubmit={handleSignUpWithEmail} />\n      </div>\n      <style>{`\n        .h3-header {\n          font-size: 22px;\n          margin: 25px 0;\n        }\n        .signup {\n          max-width: 20rem;\n          margin: 40px auto 0;\n          padding: 1rem;\n          border: 1px solid #dfe1e5;\n          border-radius: 4px;\n          text-align: center;\n          box-shadow: 0px 0px 6px 6px #f7f7f7;\n          box-sizing: border-box;\n        }\n      `}</style>\n    </>\n  );\n};\n\nexport default SignUp;\n"]},"metadata":{},"sourceType":"module"}