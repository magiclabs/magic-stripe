{"ast":null,"code":"import { __extends, __values } from \"tslib\";\nimport { PayloadTransport } from '@magic-sdk/provider';\n\nvar WebTransport =\n/** @class */\nfunction (_super) {\n  __extends(WebTransport, _super);\n\n  function WebTransport() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Initialize the underlying `Window.onmessage` event listener.\n   */\n\n\n  WebTransport.prototype.init = function () {\n    var _this = this;\n\n    window.addEventListener('message', function (event) {\n      var e_1, _a;\n\n      var _b;\n\n      if (event.origin === _this.endpoint) {\n        if (event.data && event.data.msgType && _this.messageHandlers.size) {\n          // If the response object is undefined, we ensure it's at least an\n          // empty object before passing to the event listener.\n\n          /* eslint-disable-next-line no-param-reassign */\n          event.data.response = (_b = event.data.response) !== null && _b !== void 0 ? _b : {};\n\n          try {\n            for (var _c = __values(_this.messageHandlers.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\n              var handler = _d.value;\n              handler(event);\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  return WebTransport;\n}(PayloadTransport);\n\nexport { WebTransport };","map":{"version":3,"sources":["../../src/web-transport.ts"],"names":[],"mappings":";AAAA,SAAS,gBAAT,QAAiC,qBAAjC;;AAEA,IAAA,YAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAkC,EAAA,SAAA,CAAA,YAAA,EAAA,MAAA,CAAA;;AAAlC,WAAA,YAAA,GAAA;;AAmBC;AAlBC;;AAEG;;;AACO,EAAA,YAAA,CAAA,SAAA,CAAA,IAAA,GAAV,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACE,IAAA,MAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,UAAC,KAAD,EAAoB;;;;;AACrD,UAAI,KAAK,CAAC,MAAN,KAAiB,KAAI,CAAC,QAA1B,EAAoC;AAClC,YAAI,KAAK,CAAC,IAAN,IAAc,KAAK,CAAC,IAAN,CAAW,OAAzB,IAAoC,KAAI,CAAC,eAAL,CAAqB,IAA7D,EAAmE;AACjE;AACA;;AACA;AACA,UAAA,KAAK,CAAC,IAAN,CAAW,QAAX,GAAmB,CAAA,EAAA,GAAG,KAAK,CAAC,IAAN,CAAW,QAAd,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,EAAtB,GAA0B,EAA7C;;;AACA,iBAAsB,IAAA,EAAA,GAAA,QAAA,CAAA,KAAI,CAAC,eAAL,CAAqB,MAArB,EAAA,CAAA,EAA6B,EAAA,GAAA,EAAA,CAAA,IAAA,EAAnD,EAAmD,CAAA,EAAA,CAAA,IAAnD,EAAmD,EAAA,GAAA,EAAA,CAAA,IAAA,EAAnD,EAAqD;AAAhD,kBAAM,OAAO,GAAA,EAAA,CAAA,KAAb;AACH,cAAA,OAAO,CAAC,KAAD,CAAP;AACD;;;;;;;;;;;;AACF;AACF;AACF,KAZD;AAaD,GAdS;;AAeZ,SAAA,YAAA;AAAC,CAnBD,CAAkC,gBAAlC,CAAA","sourceRoot":"","sourcesContent":["import { __extends, __values } from \"tslib\";\nimport { PayloadTransport } from '@magic-sdk/provider';\nvar WebTransport = /** @class */ (function (_super) {\n    __extends(WebTransport, _super);\n    function WebTransport() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Initialize the underlying `Window.onmessage` event listener.\n     */\n    WebTransport.prototype.init = function () {\n        var _this = this;\n        window.addEventListener('message', function (event) {\n            var e_1, _a;\n            var _b;\n            if (event.origin === _this.endpoint) {\n                if (event.data && event.data.msgType && _this.messageHandlers.size) {\n                    // If the response object is undefined, we ensure it's at least an\n                    // empty object before passing to the event listener.\n                    /* eslint-disable-next-line no-param-reassign */\n                    event.data.response = (_b = event.data.response) !== null && _b !== void 0 ? _b : {};\n                    try {\n                        for (var _c = __values(_this.messageHandlers.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\n                            var handler = _d.value;\n                            handler(event);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n            }\n        });\n    };\n    return WebTransport;\n}(PayloadTransport));\nexport { WebTransport };\n//# sourceMappingURL=web-transport.js.map"]},"metadata":{},"sourceType":"module"}