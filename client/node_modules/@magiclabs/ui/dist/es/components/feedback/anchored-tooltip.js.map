{"version":3,"file":"anchored-tooltip.js","sources":["../../../../src/components/feedback/anchored-tooltip.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useClickOutside } from 'usable-react';\nimport { useFocusWithin, useHover, useFocusVisible } from '@react-aria/interactions';\nimport { Tooltip } from './tooltip/tooltip';\nimport { mergeProps } from '../../libs/merge-props';\nimport { useSSR } from '../ssr-provider';\n\ninterface AnchoredTooltipProps extends Omit<React.ComponentProps<typeof Tooltip>, 'in'> {\n  toggle?: boolean;\n  initialToggleValue?: boolean;\n}\n\n/**\n * A high-level tooltip component. Under the hood, this component wires up the\n * supplied `anchor` with mouse/touch events to show or hide the tooltip.\n */\nexport const AnchoredTooltip: React.FC<AnchoredTooltipProps> = (props) => {\n  const { toggle, initialToggleValue, anchor: tooltipAnchor, delay, ...otherProps } = props;\n\n  const [focusWithin, setFocusWithinState] = useState(false);\n  const [hover, setHoverState] = useState(false);\n  const [showTooltip, setShowTooltip] = useState(toggle ? initialToggleValue : false);\n  const anchorRef = useRef<HTMLDivElement | null>(null);\n  const tooltipRef = useRef<HTMLDivElement | null>(null);\n  const { isServer } = useSSR();\n\n  if (!isServer) {\n    useClickOutside([tooltipRef.current, anchorRef.current], () => setShowTooltip(false), []);\n  }\n\n  const { isFocusVisible } = useFocusVisible();\n\n  const { focusWithinProps } = useFocusWithin({\n    onFocusWithinChange: useCallback((isFocused) => setFocusWithinState(isFocused && isFocusVisible), [isFocusVisible]),\n  });\n\n  const { hoverProps } = useHover({\n    onHoverChange: useCallback((isHovered) => setHoverState(isHovered), []),\n  });\n\n  useEffect(() => {\n    setShowTooltip(focusWithin || hover);\n  }, [focusWithin, hover]);\n\n  const anchor = (\n    <div {...mergeProps(hoverProps, focusWithinProps)} ref={anchorRef}>\n      {tooltipAnchor}\n    </div>\n  );\n\n  return <Tooltip in={showTooltip} anchor={anchor} delay={toggle ? 0 : delay} {...otherProps} ref={tooltipRef} />;\n};\n"],"names":[],"mappings":";;;;;;;;AAYA;;;;MAIa,eAAe,GAAmC,CAAC,KAAK;IACnE,MAAM,EAAE,MAAM,EAAE,kBAAkB,EAAE,MAAM,EAAE,aAAa,EAAE,KAAK,KAAoB,KAAK,EAApB,UAAU,UAAK,KAAK,EAAnF,mDAA2E,CAAQ,CAAC;IAE1F,MAAM,CAAC,WAAW,EAAE,mBAAmB,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC3D,MAAM,CAAC,KAAK,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC/C,MAAM,CAAC,WAAW,EAAE,cAAc,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,kBAAkB,GAAG,KAAK,CAAC,CAAC;IACpF,MAAM,SAAS,GAAG,MAAM,CAAwB,IAAI,CAAC,CAAC;IACtD,MAAM,UAAU,GAAG,MAAM,CAAwB,IAAI,CAAC,CAAC;IACvD,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,EAAE,CAAC;IAE9B,IAAI,CAAC,QAAQ,EAAE;QACb,eAAe,CAAC,CAAC,UAAU,CAAC,OAAO,EAAE,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,cAAc,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,CAAC;KAC3F;IAED,MAAM,EAAE,cAAc,EAAE,GAAG,eAAe,EAAE,CAAC;IAE7C,MAAM,EAAE,gBAAgB,EAAE,GAAG,cAAc,CAAC;QAC1C,mBAAmB,EAAE,WAAW,CAAC,CAAC,SAAS,KAAK,mBAAmB,CAAC,SAAS,IAAI,cAAc,CAAC,EAAE,CAAC,cAAc,CAAC,CAAC;KACpH,CAAC,CAAC;IAEH,MAAM,EAAE,UAAU,EAAE,GAAG,QAAQ,CAAC;QAC9B,aAAa,EAAE,WAAW,CAAC,CAAC,SAAS,KAAK,aAAa,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;KACxE,CAAC,CAAC;IAEH,SAAS,CAAC;QACR,cAAc,CAAC,WAAW,IAAI,KAAK,CAAC,CAAC;KACtC,EAAE,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC,CAAC;IAEzB,MAAM,MAAM,IACV,6CAAS,UAAU,CAAC,UAAU,EAAE,gBAAgB,CAAC,IAAE,GAAG,EAAE,SAAS,KAC9D,aAAa,CACV,CACP,CAAC;IAEF,OAAO,oBAAC,OAAO,kBAAC,EAAE,EAAE,WAAW,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,GAAG,CAAC,GAAG,KAAK,IAAM,UAAU,IAAE,GAAG,EAAE,UAAU,IAAI,CAAC;AAClH;;;;"}