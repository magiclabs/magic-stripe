{"version":3,"file":"use-clipboard.js","sources":["../../../src/hooks/use-clipboard.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/prefer-regexp-exec */\n\nimport { useCallback, useRef } from 'react';\nimport { useSSR } from '../components/ssr-provider';\n\n/**\n * Copies text to the native clipboard, either via the `navigator.clipboard`\n * API, or old `document.execCommand('copy')` hacks!\n *\n * Based on this excellent StackOverflow answer:\n * https://stackoverflow.com/a/45308151\n */\nasync function copyToClipboard(text: string) {\n  try {\n    await navigator.clipboard.writeText(text);\n  } catch {\n    const textarea = document.createElement('textarea');\n\n    // Move it off-screen.\n    textarea.style.position = 'absolute';\n    textarea.style.left = '-2147483647em';\n\n    // Set to readonly to prevent mobile devices opening a keyboard when\n    // text is .select()'ed.\n    textarea.setAttribute('readonly', true as any);\n\n    document.body.appendChild(textarea);\n\n    textarea.value = text;\n\n    // Check if there is any content selected previously.\n    const selected = (document.getSelection()?.rangeCount ?? NaN) > 0 ? document.getSelection()?.getRangeAt(0) : false;\n\n    // iOS Safari blocks programmatic execCommand copying normally, without this hack.\n    // https://stackoverflow.com/questions/34045777/copy-to-clipboard-using-javascript-in-ios\n    if (navigator.userAgent.match(/ipad|ipod|iphone/i)) {\n      const editable = textarea.contentEditable;\n      textarea.contentEditable = true as any;\n      const range = document.createRange();\n      range.selectNodeContents(textarea);\n      const selection = window.getSelection();\n      selection?.removeAllRanges();\n      selection?.addRange(range);\n      textarea.setSelectionRange(0, 999999);\n      textarea.contentEditable = editable;\n    } else {\n      textarea.select();\n    }\n\n    document.execCommand('copy');\n\n    // Restore previous selection.\n    if (selected) {\n      document.getSelection()?.removeAllRanges();\n      document.getSelection()?.addRange(selected);\n    }\n  }\n}\n\ninterface CopyFn {\n  (source?: string): void;\n  (source?: Event): void;\n  (source?: any): void;\n}\n\ninterface OnCopyHandler {\n  (value: string): void;\n}\n\n/**\n * Creates a memoized callback—`copy`—that interacts with the user's computer clipboard.\n * Also provides a `ref` to attach to inputs, which can then be used as a source\n * for the clipboard value.\n */\nexport function useClipboard(onCopy?: OnCopyHandler) {\n  const ref = useRef<HTMLInputElement | null>(null);\n  const { isServer } = useSSR();\n\n  const copy = useCallback<CopyFn>(\n    async (source?: any) => {\n      if (isServer) return;\n\n      const text =\n        typeof source === 'string'\n          ? String(source)\n          : (ref.current as HTMLInputElement)?.value ?? ref.current?.textContent ?? source?.target?.value ?? '';\n\n      await copyToClipboard(text);\n\n      if (onCopy) onCopy(text);\n    },\n    [onCopy, isServer],\n  );\n\n  return { copy, ref };\n}\n"],"names":["useRef","useSSR","useCallback"],"mappings":";;;;;;;;AAAA;AAKA;;;;;;;AAOA,SAAe,eAAe,CAAC,IAAY;;;QACzC,IAAI;YACF,MAAM,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;SAC3C;QAAC,WAAM;YACN,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;;YAGpD,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;YACrC,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,eAAe,CAAC;;;YAItC,QAAQ,CAAC,YAAY,CAAC,UAAU,EAAE,IAAW,CAAC,CAAC;YAE/C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YAEpC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC;;YAGtB,MAAM,QAAQ,GAAG,aAAC,QAAQ,CAAC,YAAY,EAAE,0CAAE,UAAU,mCAAI,GAAG,IAAI,CAAC,SAAG,QAAQ,CAAC,YAAY,EAAE,0CAAE,UAAU,CAAC,CAAC,IAAI,KAAK,CAAC;;;YAInH,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,mBAAmB,CAAC,EAAE;gBAClD,MAAM,QAAQ,GAAG,QAAQ,CAAC,eAAe,CAAC;gBAC1C,QAAQ,CAAC,eAAe,GAAG,IAAW,CAAC;gBACvC,MAAM,KAAK,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;gBACrC,KAAK,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;gBACnC,MAAM,SAAS,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;gBACxC,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,eAAe,GAAG;gBAC7B,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,QAAQ,CAAC,KAAK,EAAE;gBAC3B,QAAQ,CAAC,iBAAiB,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;gBACtC,QAAQ,CAAC,eAAe,GAAG,QAAQ,CAAC;aACrC;iBAAM;gBACL,QAAQ,CAAC,MAAM,EAAE,CAAC;aACnB;YAED,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;YAG7B,IAAI,QAAQ,EAAE;gBACZ,MAAA,QAAQ,CAAC,YAAY,EAAE,0CAAE,eAAe,GAAG;gBAC3C,MAAA,QAAQ,CAAC,YAAY,EAAE,0CAAE,QAAQ,CAAC,QAAQ,EAAE;aAC7C;SACF;;CACF;AAYD;;;;;SAKgB,YAAY,CAAC,MAAsB;IACjD,MAAM,GAAG,GAAGA,YAAM,CAA0B,IAAI,CAAC,CAAC;IAClD,MAAM,EAAE,QAAQ,EAAE,GAAGC,kBAAM,EAAE,CAAC;IAE9B,MAAM,IAAI,GAAGC,iBAAW,CACtB,CAAO,MAAY;;QACjB,IAAI,QAAQ;YAAE,OAAO;QAErB,MAAM,IAAI,GACR,OAAO,MAAM,KAAK,QAAQ;cACtB,MAAM,CAAC,MAAM,CAAC;sCACb,GAAG,CAAC,OAA4B,0CAAE,KAAK,yCAAI,GAAG,CAAC,OAAO,0CAAE,WAAW,yCAAI,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,0CAAE,KAAK,mCAAI,EAAE,CAAC;QAE1G,MAAM,eAAe,CAAC,IAAI,CAAC,CAAC;QAE5B,IAAI,MAAM;YAAE,MAAM,CAAC,IAAI,CAAC,CAAC;KAC1B,CAAA,EACD,CAAC,MAAM,EAAE,QAAQ,CAAC,CACnB,CAAC;IAEF,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC;AACvB;;;;"}